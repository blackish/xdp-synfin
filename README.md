Based on xdp-tutorial project
Simple eBPF program that count tcp packets with syn or fin flags and export counter to map
golang program reads ebpf map and export counter as rest api prometheus metrics

